# Exclude noisy audit message types
-a always,exclude -F msgtype=CRED_ACQ
-a always,exclude -F msgtype=CRED_DISP
-a always,exclude -F msgtype=CRED_REFR
-a always,exclude -F msgtype=CWD
-a always,exclude -F msgtype=LOGIN
-a always,exclude -F msgtype=PROCTITLE
-a always,exclude -F msgtype=SERVICE_START
-a always,exclude -F msgtype=SERVICE_STOP
-a always,exclude -F msgtype=USER_ACCT
-a always,exclude -F msgtype=USER_AUTH
-a always,exclude -F msgtype=USER_CMD
-a always,exclude -F msgtype=USER_END
-a always,exclude -F msgtype=USER_START
-a always,exclude -F msgtype=EOE
-a always,exclude -F msgtype=EXECVE
-a always,exclude -F msgtype=PATH -F auid<1000

# Session termination
-a always,exit -F arch=b64 -S exit,exit_group -F auid>1000 -F auid!=-1 -k tacplus
-a always,exit -F arch=b32 -S exit,exit_group -F auid>1000 -F auid!=-1 -k tacplus

# Process execution - Docker CLI
-w /usr/bin/docker -p x -k docker_commands

# Process execution - all other user execs
-a always,exit -F arch=b64 -S execve -F auid>=1000 -F auid!=-1 -k process_audit
-a always,exit -F arch=b32 -S execve -F auid>=1000 -F auid!=-1 -k process_audit

# File deletion
-a always,exit -F arch=b64 -S unlink,unlinkat -F auid>=1000 -F auid!=-1 -k file_deletion
-a always,exit -F arch=b32 -S unlink,unlinkat -F auid>=1000 -F auid!=-1 -k file_deletion

# User and group ID changes
-a always,exit -F arch=b64 -S setuid,setgid,setreuid,setregid,setresuid,setresgid,setfsuid,setfsgid -F auid>=1000 -F auid!=-1 -k user_group_management
-a always,exit -F arch=b32 -S setuid,setgid,setreuid,setregid,setfsuid,setfsgid,setresuid,setresgid -F auid>=1000 -F auid!=-1 -k user_group_management

# Kernel module operations
-w /usr/bin/kmod -p x -k modules_changes
-a always,exit -F arch=b64 -S init_module,finit_module,delete_module -F auid!=-1 -k modules_changes
-a always,exit -F arch=b32 -S init_module,finit_module,delete_module -F auid!=-1 -k modules_changes
-a always,exit -F arch=b64 -S open,openat -F dir=/lib/modules/ -F perm=r -F success=1 -k modules_changes
-a always,exit -F arch=b32 -S open,openat -F dir=/lib/modules/ -F perm=r -F success=1 -k modules_changes

# Authentication and session logs
-w /var/log/auth.log -p wa -k auth_logs
-w /var/log/wtmp -p wa -k shutdown_reboot

# Cron configuration
-w /etc/crontab -p wa -k cron_changes
-w /etc/cron.d -p wa -k cron_changes
-w /etc/cron.daily -p wa -k cron_changes
-w /etc/cron.hourly -p wa -k cron_changes
-w /etc/cron.weekly -p wa -k cron_changes
-w /etc/cron.monthly -p wa -k cron_changes

# DNS configuration
-w /etc/resolv.conf -p wa -k dns_changes
-w /run/resolvconf/resolv.conf -p wa -k dns_changes

# Docker configuration and services
-w /etc/docker/daemon.json -p wa -k docker_config
-w /usr/bin/dockerd -p wa -k docker_daemon
-w /lib/systemd/system/docker.service -p wa -k docker_service
-w /lib/systemd/system/docker.socket -p wa -k docker_socket
-a always,exit -F arch=b64 -S open,openat -F dir=/var/lib/docker -F perm=w -F success=1 -k docker_storage
-a always,exit -F arch=b32 -S open,openat -F dir=/var/lib/docker -F perm=w -F success=1 -k docker_storage

# Account databases
-w /etc/passwd -p wa -k passwd_changes
-w /etc/shadow -p wa -k shadow_changes
-w /etc/group -p wa -k group_changes

# Hosts and networking
-w /etc/hosts -p wa -k hosts_changes

# Time configuration
-w /etc/localtime -p wa -k time_changes
-w /usr/share/zoneinfo/Etc/UTC -p wa -k time_changes

# Binary directories (recursive, PATH records on writes/creates)
-a always,exit -F arch=b64 -S open,openat -F dir=/bin -F perm=w -F success=1 -k usr_bin_changes
-a always,exit -F arch=b64 -S open,openat -F dir=/usr/bin -F perm=w -F success=1 -k usr_bin_changes
-a always,exit -F arch=b64 -S open,openat -F dir=/sbin -F perm=w -F success=1 -k usr_sbin_changes
-a always,exit -F arch=b64 -S open,openat -F dir=/usr/sbin -F perm=w -F success=1 -k usr_sbin_changes
-a always,exit -F arch=b32 -S open,openat -F dir=/bin -F perm=w -F success=1 -k usr_bin_changes
-a always,exit -F arch=b32 -S open,openat -F dir=/usr/bin -F perm=w -F success=1 -k usr_bin_changes
-a always,exit -F arch=b32 -S open,openat -F dir=/sbin -F perm=w -F success=1 -k usr_sbin_changes
-a always,exit -F arch=b32 -S open,openat -F dir=/usr/sbin -F perm=w -F success=1 -k usr_sbin_changes

# System logs (recursive, PATH records on writes/creates)
-a always,exit -F arch=b64 -S open,openat -F dir=/var/log -F perm=w -F success=1 -k log_changes
-a always,exit -F arch=b32 -S open,openat -F dir=/var/log -F perm=w -F success=1 -k log_changes